cuda
torch.Size([50000, 10])
torch.Size([50000, 4])
torch.Size([50000, 2])
torch.Size([10000, 10])
torch.Size([10000, 4])
torch.Size([10000, 2])
Train size: 50000 Val size: 10000
Training Hierarchical NAM...
Phase1 architecture: [ReLU: 64, ReLU: [64, 32]]
  0%|                                                                                                                                                                                                                        | 0/1000 [00:00<?, ?it/s]


















































  5%|██████████▎                                                                                                                                                                                                  | 50/1000 [05:33<1:36:50,  6.12s/it]



















































 10%|████████████████████▌                                                                                                                                                                                       | 101/1000 [11:12<1:29:22,  5.96s/it]

















































 15%|██████████████████████████████▌                                                                                                                                                                             | 150/1000 [15:50<1:20:43,  5.70s/it]


















































 20%|████████████████████████████████████████▊                                                                                                                                                                   | 200/1000 [20:39<1:15:47,  5.68s/it]





 20%|█████████████████████████████████████████▌                                                                                                                                                                  | 204/1000 [21:10<1:22:37,  6.23s/it]
Early stopping triggered!
torch.Size([500, 10])
torch.Size([500, 4])
torch.Size([500, 2])
Traceback (most recent call last):
  File "run_model.py", line 148, in <module>
    main()
  File "run_model.py", line 142, in main
    get_shape_functions_synthetic_data(hirarch_nam, args, num_test_exp=500)
  File "/home/yuvalzehavi1/Repos/multi-classification-NAM/utils/visualize_shape_functions.py", line 97, in get_shape_functions_synthetic_data
    visualize_combined_gam(model, x_values, input_dim, output_dim, shape_functions_phase1, vis_lat_features=True)
  File "/home/yuvalzehavi1/Repos/multi-classification-NAM/utils/visualize_shape_functions.py", line 133, in visualize_combined_gam
    feature_output = model.feature_nns[i](feature_input[:, 0])[:, j].cpu().numpy()
  File "/home/yuvalzehavi1/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'HierarchNeuralAdditiveModel' object has no attribute 'feature_nns'